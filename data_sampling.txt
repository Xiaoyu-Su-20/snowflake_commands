CREATE OR REPLACE TRANSIENT DATABASE SAMPLING_DB;


-- use row sampling, 1% data
CREATE OR REPLACE VIEW ADDRESS_SAMPLE
AS 
SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
SAMPLE ROW (1) SEED(27);

SELECT * FROM ADDRESS_SAMPLE


-- calculate the percentage of data by CA_LOCATION_TYPE
SELECT CA_LOCATION_TYPE, COUNT(*)/(SELECT COUNT(*) FROM ADDRESS_SAMPLE)*100
FROM ADDRESS_SAMPLE
GROUP BY CA_LOCATION_TYPE
