-- Cloning

SELECT * FROM TEST_DB.PUBLIC.CUSTOMERS

CREATE TABLE TEST_DB.PUBLIC.CUSTOMERS_CLONE
CLONE TEST_DB.PUBLIC.CUSTOMERS


-- Validate the data
SELECT * FROM TEST_DB.PUBLIC.CUSTOMERS_CLONE


-- Update cloned table

UPDATE TEST_DB.public.CUSTOMERS_CLONE
SET LAST_NAME = NULL

SELECT * FROM TEST_DB.PUBLIC.CUSTOMERS 

SELECT * FROM TEST_DB.PUBLIC.CUSTOMERS_CLONE






-- can only clone a temporary table if the new table is also temporary
CREATE OR REPLACE TEMPORARY TABLE TEST_DB.PUBLIC.TEMP_TABLE(
  id int)

CREATE TEMPORARY TABLE TEST_DB.PUBLIC.TABLE_COPY
CLONE TEST_DB.PUBLIC.TEMP_TABLE

SELECT * FROM TEST_DB.PUBLIC.TABLE_COPY